DROP PROCEDURE IF EXISTS searchtextbooktotal;
DELIMITER //
CREATE PROCEDURE searchtextbooktotal(IN m TEXT) 
BEGIN
  DECLARE lastrow INT;
  DECLARE total INT;
  
  DECLARE sresults CURSOR FOR
		SELECT 	searchId, MATCH(searchContent) AGAINST (m IN BOOLEAN MODE) AS score 
		FROM 	vsf_search, vsf_textbook_user, vsf_listing_textbook 
		WHERE 	searchObj = tubook AND ltTU = tuId AND tuVerify = 0 AND tuStatus = 1 
				AND MATCH(searchContent) AGAINST (m  IN BOOLEAN MODE) > 0
		GROUP BY searchObj;
		
		
  
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET lastrow=1;
  SET lastrow=0;  
     
  
  
	
  OPEN sresults;
	SELECT FOUND_ROWS() INTO total;	
  CLOSE sresults;
  
  SET lastrow=0;
  
  SELECT total;
END //
DELIMITER ;

CALL searchtextbooktotal('ruby');